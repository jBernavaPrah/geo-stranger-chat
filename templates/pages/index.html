{% extends "layout.html" %}

{% block title %}Home{% endblock %}




{% block content %}
    <div class="row center mt-md">
        <div class="col-md-12">

            <p class="lead">
                <b>Site under construction</b>.
            </p>

            <h1 class="mb-sm">
                GeoStranger: <strong class="inverted">anonymous</strong> messaging.
            </h1>
            <br>
            <p class="lead">
                Use Telegram, Kik, Skype, Messenger or <a href="#instant_messaging">others</a> and <b> to find and talk
                with Stranger near you!</b>.
            </p>

            <hr class="tall mb-none">

        </div>
    </div>


    <!-- Google Maps -->
    <div class="row">
        <div class="col-md-12">

            <div id="googlemaps" class="google-map mt-none mb-sm"></div>


        </div>
    </div>




{% endblock %}


{% block instant_messaging %}
    <section class="section section-primary mt-none" id="instant_messaging">
        <div class="container center">
            <div class="row">
                <div class="col-md-12">

                    <h2 class="mb-sm">Start Online with <strong class="inverted">WebChat</strong></h2>

                    <a href="{{ url_for('index.webchat_page') }}" class="btn btn-lg btn-success center">Start WebChat
                        -></a>

                    <h2 class="mb-sm mt-lg">Or... Find our service in your <strong>Instant Messaging</strong></h2>
                    <p class="lead">Use your prefer Instant Messaging and talk with all other users thanks with our
                        Bot!</p>

                    <div class="row">

                        <div class="col-md-12">

                            <div class="row">


                                <div class="col-md-3">

                                    <span class="thumb-info thumb-info-hide-wrapper-bg">
                                        <span class="thumb-info-wrapper">
                                            <img src="{{ url_for('static',filename="img/bot/telegram_logo.png") }}"
                                                 class="img-responsive" alt="">
                                            <span class="thumb-info-title">
                                                <span class="thumb-info-inner">Telegram</span>
                                            </span>
                                        </span>
                                        <span class="thumb-info-caption">
                                            <span class="thumb-info-caption-text">To add bot to your client click here:
                                                <a href="https://t.me/geostrangerbot">https://t.me/geostrangerbot</a> or search
                                                <b>@GeoStrangerBot</b> into client.</span>

                                        </span>
                                    </span>
                                </div>

                                <div class="col-md-3">

                                    <span class="thumb-info thumb-info-hide-wrapper-bg">
                                        <span class="thumb-info-wrapper">
                                            <img src="{{ url_for('static',filename="img/bot/Kik_Messenger_Logo.png") }}"
                                                 class="img-responsive" alt="">
                                            <span class="thumb-info-title">
                                                <span class="thumb-info-inner">Beta: KIK</span>

                                            </span>
                                        </span>
                                        <span class="thumb-info-caption">
                                            <span class="thumb-info-caption-text">To add to kik client search into
                                                <i>Bot Shop</i> <b>@GeoStrangerBot</b>.</span>
                                        </span>
                                    </span>
                                </div>


                                <div class="col-md-3">

                                    <span class="thumb-info thumb-info-hide-wrapper-bg">
                                        <span class="thumb-info-wrapper">
                                            <img src="{{ url_for('static',filename="img/bot/messenger_logo.png") }}"
                                                 class="img-responsive" alt="">
                                            <span class="thumb-info-title">
                                                <span class="thumb-info-inner">Beta: Skype</span>
                                            </span>
                                        </span>
                                        <span class="thumb-info-caption">
                                            <span class="thumb-info-caption-text">Add to your contact this bot:
                                                <b>@GeoStrangerBot</b>.</span>

                                        </span>
                                    </span>
                                </div>


                            </div>

                        </div>
                    </div>


                </div>
            </div>
        </div>
    </section>

{% endblock %}


{% block page_javascript %}
    <script type="text/javascript"
            src="https://maps.google.com/maps/api/js?sensor=true&key=AIzaSyCXc18EdAuOgogqdIoTNdR5YoBq99pa2LA"></script>
    <script type="text/javascript"
            src="{{ url_for('static', filename='vendor/jquery.gmap/jquery.gmap.min.js') }}"></script>
    <script>

        function getBoundsRadius(bounds) {
            // r = radius of the earth in km
            var r = 6378.8;
            // degrees to radians (divide by 57.2958)
            var ne_lat = bounds.getNorthEast().lat() / 57.2958;
            var ne_lng = bounds.getNorthEast().lng() / 57.2958;
            var c_lat = bounds.getCenter().lat() / 57.2958;
            var c_lng = bounds.getCenter().lng() / 57.2958;
            // distance = circle radius from center to Northeast corner of bounds
            var r_km = r * Math.acos(
                Math.sin(c_lat) * Math.sin(ne_lat) +
                Math.cos(c_lat) * Math.cos(ne_lat) * Math.cos(ne_lng - c_lng)
            );
            return r_km * 1000 // radius in meters
        }

        var gmap_ele = $('#googlemaps');

        gmap_ele.gMap({
            controls: false,
            scrollwheel: true,
        });
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
                {#          gmap_ele.gMap('addMarker', {
                            latitude: position.coords.latitude,
                            longitude: position.coords.longitude,
                            content: 'You are here!',
                            popup: true
                          });#}
                // getBoundsRadius(gmap_ele.data('gMap.reference').getBounds())
                // {{ url_for('api.users_location') }}
                $.get(
                    "{{ url_for('api.users_location',_external=True, _scheme='https') }}", {
                    'latitude': position.coords.latitude,
                    'longitude': position.coords.longitude,
                    'range': getBoundsRadius(gmap_ele.data('gMap.reference').getBounds())
                }, function (data) {
                    alert(data);
                });

                gmap_ele.gMap('centerAt', {
                    latitude: position.coords.latitude,
                    longitude: position.coords.longitude,
                    zoom: 8
                });


            }, function () {

            });
        }

    </script>
{% endblock %}